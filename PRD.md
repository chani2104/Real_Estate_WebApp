# 네이버 부동산 매물 수집기 PRD (Product Requirements Document)

## 1. 문서 개요

| 항목 | 내용 |
|------|------|
| 프로젝트명 | 네이버 부동산 매물 수집기 (Naver Real Estate Scraper) |
| 버전 | 1.0 |
| 작성일 | 2026-02-24 |
| 참조 문서 | ApiRef.md |

---

## 2. 프로젝트 목적

사용자가 **지역을 입력**하면 해당 지역의 모든 부동산 매물 정보를 **네이버 부동산 API**를 통해 수집하고, GUI로 조회·저장할 수 있는 데스크톱 애플리케이션을 개발한다.

---

## 3. 핵심 요구사항 요약

- **입력:** 사용자가 지역(주소, 동/읍/면, 시/군/구 등) 입력
- **처리:** 네이버 부동산 clusterList, articleList API를 활용한 매물 데이터 수집
- **출력:** GUI 테이블에 매물 목록 표시, 엑셀 파일로 저장
- **GUI 프레임워크:** PySide6 (Qt for Python)

---

## 4. 기능 요구사항

### 4.1 지역 검색 및 매물 수집

| ID | 요구사항 | 상세 |
|----|----------|------|
| F-01 | 지역 입력 | 사용자가 검색할 지역을 텍스트로 입력 (예: "강원도 태백시", "서울 강남구", "황지동") |
| F-02 | 지역 → 좌표/법정동코드 변환 | 입력된 지역명을 cortarNo(법정동코드), lat, lon으로 변환하는 로직 필요 (네이버 지도 API 또는 사전 정의 매핑 테이블 활용 검토) |
| F-03 | 매물 수집 실행 | clusterList → articleList 순차 호출로 전체 매물 데이터 수집 |
| F-04 | 페이지네이션 처리 | articleList 응답의 `more: true` 시 `page` 증가하여 추가 페이지 요청 반복 |
| F-05 | 수집 진행 상태 표시 | 수집 중 진행률, 수집된 매물 수, 예상 소요 시간 등 표시 |

### 4.2 매물 데이터 표시 (GUI)

| ID | 요구사항 | 상세 |
|----|----------|------|
| F-06 | 테이블 뷰 | 수집된 매물을 테이블(QTableWidget 또는 QTableView) 형태로 표시 |
| F-07 | 표시 컬럼 | ApiRef.md 기반 주요 필드: 매물ID, 단지/건물명, 매물유형, 거래유형, 가격, 월세, 면적(㎡), 층, 방향, 중개사, 직거래, 확인일자, 특징설명 등 |
| F-08 | 정렬/필터 | 컬럼 헤더 클릭 시 정렬, (선택) 간단한 필터(거래유형, 매물유형) |
| F-09 | 상세 보기 | 행 선택 시 해당 매물의 상세 정보를 패널 또는 다이얼로그로 표시 (선택 기능) |
| F-10 | 빈 결과 처리 | 매물이 없을 경우 안내 메시지 표시 |

### 4.3 엑셀 저장

| ID | 요구사항 | 상세 |
|----|----------|------|
| F-11 | 엑셀 저장 버튼 | "엑셀로 저장" 버튼 제공 |
| F-12 | 파일 저장 대화상자 | 저장 경로 및 파일명 지정 (기본값: `매물목록_지역명_날짜.xlsx`) |
| F-13 | 엑셀 포맷 | openpyxl 또는 pandas 활용, 표시된 테이블 데이터와 동일한 컬럼 구조로 저장 |
| F-14 | 저장 전 데이터 검증 | 수집된 데이터가 없으면 저장 불가 안내 |

### 4.4 기타 기능

| ID | 요구사항 | 상세 |
|----|----------|------|
| F-15 | 매물 유형/거래 유형 선택 | (선택) 아파트만, 월세만 등 필터 옵션 제공 |
| F-16 | 수집 중단 | 수집 진행 중 "중단" 버튼으로 취소 |
| F-17 | 최근 검색 지역 | (선택) 최근 검색한 지역 목록 저장 및 빠른 재검색 |

---

## 5. 비기능 요구사항

| ID | 요구사항 | 상세 |
|----|----------|------|
| NF-01 | GUI 반응성 | 수집 작업은 별도 스레드(QThread)에서 수행, UI 프리징 방지 |
| NF-02 | 에러 처리 | API 오류, 네트워크 오류 시 사용자에게 명확한 메시지 표시 |
| NF-03 | 요청 간격 | API 호출 시 적절한 딜레이(예: 0.5~1초) 적용하여 차단 위험 감소 |
| NF-04 | User-Agent/Referer | ApiRef.md 권장사항 준수 (모바일 UA, Referer 설정) |
| NF-05 | 크로스 플랫폼 | Windows, macOS, Linux에서 동작 (PySide6 지원 범위 내) |

---

## 6. GUI 설계 (PySide6)

### 6.1 화면 구성

```
┌─────────────────────────────────────────────────────────────────┐
│  네이버 부동산 매물 수집기                                    [_][□][×] │
├─────────────────────────────────────────────────────────────────┤
│  [지역 검색]  [________________________]  [검색]  [수집 시작]     │
│                                                                  │
│  진행 상태: ● 수집 중... (45/120 건)  [중단]                      │
│  ─────────────────────────────────────────────────────────────  │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │ 매물ID │ 단지명 │ 유형 │ 거래 │ 가격 │ 면적 │ 층 │ ... │  │  │
│  ├───────┼────────┼─────┼──────┼──────┼──────┼────┼─────┤  │  │
│  │ 2609..│ 태백.. │아파트│ 월세 │500/50│38.36 │12/15│ ... │  │  │
│  │ 2609..│ 연립   │ 빌라 │ 전세 │ 3000 │43.08 │ 2/3 │ ... │  │  │
│  │  ...  │  ...   │ ...  │ ...  │ ...  │ ...  │ ... │ ... │  │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                  │
│  [엑셀로 저장]                              총 120건              │
└─────────────────────────────────────────────────────────────────┘
```

### 6.2 주요 위젯

| 영역 | 위젯 | 설명 |
|------|------|------|
| 상단 | QLineEdit | 지역 입력 필드 |
| 상단 | QPushButton | "검색", "수집 시작" 버튼 |
| 진행 | QProgressBar / QLabel | 수집 진행률, 건수 표시 |
| 본문 | QTableWidget | 매물 목록 테이블 |
| 하단 | QPushButton | "엑셀로 저장" 버튼 |
| 상태 | QStatusBar | 총 건수, 상태 메시지 |

### 6.3 레이아웃

- **메인 레이아웃:** QVBoxLayout
- **상단:** QHBoxLayout (입력, 버튼)
- **본문:** QTableWidget (스크롤 가능)
- **하단:** QHBoxLayout (저장 버튼, 건수)

---

## 7. 기술 스택

| 구분 | 기술 |
|------|------|
| GUI | PySide6 (Qt 6) |
| HTTP 요청 | requests |
| 데이터 처리 | pandas (선택, 엑셀 저장 시 유용) |
| 엑셀 저장 | openpyxl 또는 pandas.to_excel |
| 비동기/스레드 | QThread, pyqtSignal |

### 7.1 의존성 패키지 (requirements.txt 예시)

```
PySide6>=6.5.0
requests>=2.28.0
pandas>=2.0.0
openpyxl>=3.1.0
```

---

## 8. 데이터 흐름

```
[사용자: 지역 입력]
        ↓
[지역명 → cortarNo, lat, lon 변환]  ← (구현 시 네이버 검색 API 또는 매핑 DB 활용)
        ↓
[clusterList API 호출] → totCnt, 지역 정보 획득
        ↓
[articleList API 호출] (page=1, 2, ... more가 false일 때까지)
        ↓
[JSON 파싱 → 매물 리스트]
        ↓
[GUI 테이블에 표시] ← [QThread에서 수집, Signal로 UI 업데이트]
        ↓
[사용자: 엑셀로 저장 클릭]
        ↓
[파일 저장 대화상자] → [openpyxl/pandas로 .xlsx 생성]
```

---

## 9. 지역 검색 구현 방안

API가 **cortarNo, lat, lon**을 필요로 하므로, "지역명" → "법정동코드/좌표" 변환이 선행되어야 한다.

| 방안 | 설명 | 난이도 |
|------|------|--------|
| A | 네이버 지도/부동산 검색 API 활용 (공개 API 존재 여부 확인 필요) | 중 |
| B | 법정동코드 매핑 CSV/DB 구축 후 지역명 검색 | 중 |
| C | 초기에는 cortarNo 직접 입력 또는 드롭다운으로 시/도·시/군/구 선택 | 하 |
| D | 네이버 부동산 웹 검색 페이지 파싱하여 지역 검색 시 cortarNo 추출 | 중 |

**권장:** MVP에서는 **방안 C**로 cortarNo 직접 입력 또는 시/도 목록 선택 UI를 제공하고, 이후 **방안 B** 또는 **방안 A**로 지역명 검색을 확장한다.

---

## 10. 에러 시나리오 및 처리

| 시나리오 | 처리 |
|----------|------|
| 네트워크 연결 실패 | "네트워크 연결을 확인해 주세요" 메시지, 재시도 안내 |
| API 403/429 | "일시적으로 접근이 제한되었습니다. 잠시 후 다시 시도해 주세요" |
| 잘못된 cortarNo | "해당 지역을 찾을 수 없습니다" |
| 매물 0건 | "해당 지역에 매물이 없습니다" 안내 |
| 엑셀 저장 실패 | "파일 저장에 실패했습니다. 경로와 권한을 확인해 주세요" |

---

---

## 12. 산출물 목록

| 산출물 | 설명 |
|--------|------|
| main.py | 애플리케이션 진입점, QApplication 실행 |
| main_window.py | 메인 윈도우 클래스, 레이아웃 및 위젯 구성 |
| scraper.py | 네이버 부동산 API 호출, 데이터 파싱 |
| worker.py | QThread 기반 수집 워커, Signal/Slot |
| utils.py | 지역 변환, 엑셀 저장 유틸 |
| requirements.txt | 패키지 의존성 |
| PRD.md | 본 문서 |
| ApiRef.md | API 분석 참조 문서 |

---

## 13. 제약사항 및 유의사항

- 네이버 부동산 서비스는 공식 공개 API가 아니므로, 구조 변경 시 스크래퍼 수정 필요
- 과도한 요청 시 IP 차단 가능성 → 요청 간격, 재시도 로직 적용
- 이용약관, robots.txt 준수 필요
- 수집된 데이터의 상업적 이용 시 법적 검토 필요
